<!DOCTYPE html>
<html>
  <head>
    <script src="lib/jquery.js"></script>
    <script src="dataGenerator.js"></script>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div id="app"></div>  <!-- Your Entire Application will be built inside this div! -->

    <script>
      $(document).ready(function(){
        var $app = $('#app');
        var $header = $('<header><h1>Twiddler</h1></header>');
        // $header.on("click", function(event) {
        //   $(event.target).css({"fontface": "Arial", "fontweight": "bolder"});
        // });
        // var $title = $('<h1>Twiddler</h1>');
        var $updateFeedButton = $('<button>Update</button>');

        var $newTweetForm = $('<div id="new_tweet_form"</div>');

        var $feed = $('<div id="feed"></div>');//.css({ "background-color": "#ffe", "border-left": "5px solid #ccc" });

        var $friendsList = $('<div id="friends_list"></div>');

        var populatesFriends = function () {
          var index = 0;
          while (index < window.users.length) {
            var $userName = $('<div id=user_name><p><b>' + window.users[index] + '</b></p></div>');
              populateTweets(event.target.innerText);
              // toggle update button with home button calling populateTweets() on click
            });
            $userName.appendTo($friendsList);
            index += 1;
          }
        }

        $app.html('');
        $updateFeedButton.appendTo($header);
        $header.appendTo($app)
        // $title.appendTo($app);
        $feed.appendTo($app);
        $friendsList.appendTo($app);

        // $userName.on("click", function(event) {
        //   alert($userName);
        // }


        // $title.on("click", function(event) {
          // console.log(event);
          // alert('The title of this page is ' + event.target.innerText)
        // });

        var populateTweets = function(userName) {
          var userFlag = false;
          if (!!userName) {
            userFlag = true;
          }
          var index = 0;
          var createsTweetDivs = function() {
            var stream;
            !userFlag ? stream = streams.home : stream = streams.users[userName];
            while(index < stream.length){
              var tweet = stream[index];
              var $tweet = $('<div class="tweet"></div>');
              var $user = $('<span class="tweet" id=user> @'+ tweet.user + '</span>');
              var $pic = $('<div id=user_image><img src='+tweet.profilePhotoURL+'></img></div>');
              $pic.appendTo($tweet);
              var $message = $('<p class="tweet" id=message>' + tweet.message + '</p>');
              $tweet.append($message);
              var $time = $('<div id="tweet_time"><h3>' + 'Posted at ' + tweet.created_at.toLocaleTimeString() + '</h3></div>');
              // $time.text('Posted at ' + tweet.created_at.toLocaleTimeString());
              $user.appendTo($tweet);
              $time.appendTo($tweet);

              $tweet.prependTo($feed);
              // console.log("Number of tweets: " + streams.home.length);
              // console.log("Most Recent Tweet Element: " + JSON.stringify(streams.home[index - 1]));
              console.log(index);
              index += 1;
            }
          };
          return createsTweetDivs();
        }
        populateTweets();
        populatesFriends();

        $updateFeedButton.on("click", function(event) {
          console.log(event);
          populateTweets();
        });

      });
    </script>
  </body>
</html>
